---
description: Test conventions for based using GoogleTest
globs: tests/**/*.cpp
alwaysApply: false
---

# Test Conventions

Tests live in `tests/` as `.cpp` files (C++20). The library is C11, so wrap includes with `extern "C"`.

Code must conform to `.clang-format` and `.clang-tidy` just like the library sources.

## File structure

Every test file opens with:
```cpp
// MIT License
// Copyright (c) 2026 Christian Luppi
```

Use the same `// ===...=== // Section Title // ===...===` banner separators when grouping related test suites in a single file.

## Structure

```cpp
// MIT License
// Copyright (c) 2026 Christian Luppi

#include <gtest/gtest.h>

extern "C" {
#include "based.h"
}

TEST(suite_name, test_description) {
  EXPECT_EQ(based_add(2, 3), 5);
}
```

## Naming

- Suite name = function or module under test (snake_case): `based_add`
- Test description = short scenario (snake_case): `positive_numbers`, `returns_null_on_empty`
- Group related cases under the same suite name

## Assertions

Prefer `EXPECT_*` over `ASSERT_*` unless subsequent lines would be invalid after failure.

Common macros: `EXPECT_EQ`, `EXPECT_NE`, `EXPECT_TRUE`, `EXPECT_FALSE`, `EXPECT_STREQ`, `EXPECT_NEAR`.
